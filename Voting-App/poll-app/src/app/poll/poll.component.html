<div class="poll-container">
    <h2 class="poll-heading text-center">アンケート一覧</h2>

    @if (loading) {
    <!-- 読み込み中 -->
    <div class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">アンケートを読み込んでいます...</p>
    </div>
    } @else if (error) {
    <!-- エラー発生時 -->
    <div class="alert alert-danger text-center my-4 mx-auto" style="max-width: 600px;">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ error }}
        <button class="btn btn-sm btn-outline-danger ms-3" (click)="loadPolls()">再試行</button>
    </div>
    } @else {
    @if (polls.length > 0) {
    <!-- アンケート一覧 -->
    <div class="animate-fadeIn">
        @for (poll of polls; track poll.id) {
        <div class="poll-card">
            <h3 class="poll-question">{{ poll.question }}</h3>
            <div class="options-list">
                @for (option of poll.options; track $index) {
                <div class="option-item">
                    <button class="vote-btn" (click)="vote(poll.id, $index)">
                        <span class="option-text">{{ option.voteOption }}</span>
                        <span class="vote-count">{{ option.voteCount }} votes</span>
                        <div class="progress-container" [style.width.%]="getPercentage(poll, option.voteCount)"></div>
                    </button>
                </div>
                }
            </div>
        </div>
        }
    </div>
    } @else if (initialized) {
    <!-- データなし -->
    <div class="text-center py-5">
        <p class="text-muted">利用可能なアンケートがありません。</p>
    </div>
    }
    }
</div>